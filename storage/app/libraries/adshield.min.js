AdShield=function(){var s=this;s.urls={};s.UserKey=null;s.AdShieldType=3;s.violationId=0;this.Element&&function(e){e.matches=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.msMatchesSelector||function(e){var t=this,n=(t.parentNode||t.document).querySelectorAll(e),i=-1;while(n[++i]&&n[i]!=t);return!!n[i]}}(Element.prototype);this.Element&&function(e){e.closest=e.closest||function(e){var t=this;while(t.matches&&!t.matches(e))t=t.parentNode;return t.matches?t:null}}(Element.prototype);GetParameterByName=function(e,t){if(!t)t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);if(!i)return null;if(!i[2])return"";return decodeURIComponent(i[2].replace(/\+/g," "))};s.httpGet=function(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(this.readyState==4&&this.status==200){n(this.responseText.toJSON())}};i.open("GET",e,true);var o=JSON.stringify(t);i.send(o)};s.httpPost=function(e,t,n){var i=new XMLHttpRequest;i.open("POST",e,true);i.addEventListener("load",function(){try{var e=JSON.parse(this.responseText);n(e)}catch(e){n({})}});i.setRequestHeader("Content-Type","application/json");i.send(JSON.stringify(t))};s.SendStatLog=function(e){var t=document.referrer;var n=encodeURIComponent(t);if(t.indexOf("://")>-1){domain=t.split("/")[2]}else{domain=t.split("/")[0]}domain=domain.split(":")[0];var i=document.location.toString()||"";var o=GetParameterByName("utm_source");var r=GetParameterByName("utm_medium");var a={key:s.UserKey,url:domain,full_url:n,status:e,source:o,sub_source:r,user_agent:navigator.userAgent,visitUrl:i};s.httpPost(s.urls.statlog,a,function(e){})};s.CheckIframed=function(){if(window.top!=window.self){document.querySelectorAll("a").forEach(function(e){e.onclick=function(){window.open(e.href);return false}});s.SendStatLog(5);return true}return false};s.CheckReferrerUrl=function(){var e=document.referrer;if(e==""){if(window.top==window.self)s.SendStatLog(7);return}var t=encodeURIComponent(document.referrer);if(e.indexOf("://")>-1){domain=e.split("/")[2]}else{domain=e.split("/")[0]}domain=domain.split(":")[0];var n=GetParameterByName("utm_source");var i=GetParameterByName("utm_medium");var o={key:s.UserKey,url:domain,fullUrl:t,source:n,sub_source:i,user_agent:navigator.userAgent};s.httpPost(s.urls.checkReferrer,o,function(e){switch(e.result){case"{{ ReferrerFilterController::STATUS_SAFE }}":break;case"{{ ReferrerFilterController::STATUS_UNKNOWN }}":break;case"{{ ReferrerFilterController::STATUS_UNSAFE }}":break;default:}},"json")};var e=null;s.StartAdShield=function(){var n="ins.adsbygoogle ins ins, div.advertiseAd, div.redirectAd, div[id^='rcjsload'], div.zergnetAd,iframe[src*='yieldtraffic.com']";var e=s.AdShieldType;if(typeof e!="undefined"){if(e=="0"){return}else{shield_type=e}}var i="as"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);if(shield_type=="1"){var t=n;s.ActivateShieldForAds(i,t)}else if(shield_type=="2"){var o=document.createElement("div");o.style.position="fixed";o.style.top=0;o.style.left=0;o.style.right=0;o.style.bottom=0;o.style.background="#000";o.style.opacity="0.0";o.id=i;document.querySelector("body").appendChild(o)}else if(shield_type=="3"){s.ClickedMyAd.init({selectors:n,onClick:function(){try{fbq("track","AdClick")}catch(e){}try{dataLayer.push({event:"Adsense Click"})}catch(e){}s.LogAdShieldClick(function(e,t){if(t===0)window.location=""},{ad_type:s.ClickedMyAd.adType,status:s.ClickedMyAd.statusValue})}});s.ClickedMyAd.statusValue=0}else{return}s.SetAdshieldOnClick(i,shield_type);s.httpPost(s.urls.adShieldHandler,{checkip:1,key:s.UserKey},function(e){switch(e.status){case"1":s.ClickedMyAd.statusValue=1;document.querySelectorAll("div#"+i).forEach(function(e){e.parentNode.removeChild(e)});break;case"2":if(shield_type=="3"){var t=n;s.ActivateShieldForAds(i,t);s.SetAdshieldOnClick(i,shield_type);s.ClickedMyAd.statusValue=0;s.ClickedMyAd.setClickCatch(true);s.ClickedMyAd.lateShielding=function(e){s.ActivateShieldForAds(i,e);s.SetAdshieldOnClick(i,3)}}break;case"0":window.location="http://redirect.com";break}},"json")};s.SetAdshieldOnClick=function(e,n){document.querySelectorAll("body div#"+e).forEach(function(e){e.removeEventListener("click")});document.querySelectorAll("div#"+e).forEach(function(e){e.removeEventListener("click")});document.querySelectorAll("div#"+e).forEach(function(e){e.click(function(){s.LogAdShieldClick(function(e,t){if(t===0)window.location="http://redirect.com";if(n=="3"){s.ClickedMyAd.setClickCatch(false);s.ClickedMyAd.statusValue=1}else{}})})})};s.RenderCaptcha=function(){};s.LogAdShieldClick=function(t,e){var n=navigator.userAgent;var i=document.referrer;var o=document.location.href;var r=GetParameterByName("utm_medium");var a={key:s.UserKey,userAgent:encodeURIComponent(n),refererUrl:encodeURIComponent(i),targetUrl:encodeURIComponent(o),subsource:r,lgadclk:1};if(typeof e!="undefined"){if(typeof e.ad_type!="undefined")a.ad_type=e.ad_type;if(typeof e.status!="undefined")a.status=e.status}s.httpPost(s.urls.adShieldHandler,a,function(e){t(e.id,e.status)},"json")};s.ActivateShieldForAds=function(a,e){document.querySelectorAll(e).forEach(function(e){var t=document.createElement("div");t.style.position="absolute";t.style.top=0;t.style.left=0;t.style.width="100%";t.style.height="100%";t.style.background="#000";t.style.opacity="0.0";t.style.zIndex="1";t.id=a;var n=e.tagName;if(n=="IFRAME"){var i=document.createElement("div");e.parentNode.insertBefore(i,e);i.appendChild(e);var o=e;var r=o.closest("div");r.style.position="relative";r.appendChild(t)}else{e.style.position="relative";e.appendChild(t)}})};s.ClickedMyAd={overAnAd:false,clickIsHandled:false,statusValue:0,adType:0,selectors:"ins.adsbygoogle ins ins",isMouseMoving:false,onClick:function(){},init:function(e){var t=this;if(typeof e.selectors!="undefined")t.selectors=e.selectors;if(typeof e.onClick!="undefined")t.onClick=e.onClick;document.querySelectorAll(t.selectors).forEach(function(e){e.onmouseover=function(){if(t.overAnAd)return;t.overAnAd=true;t.adType=t.getType(e)};e.onmouseout=function(){if(t.isMouseMoving)t.overAnAd=false}});window.onblur=function(){if(t.clickIsHandled)return;if(!t.overAnAd)return;t.onClick();t.overAnAd=false};window.focus();var n;document.onmousemove=function(){t.isMouseMoving=true;clearTimeout(n);n=setTimeout(function(){t.isMouseMoving=false},500)}},getType:function(e){var t=e.tagName;var n=typeof e.id=="undefined"?"":e.id;var i=typeof e.className=="undefined"?"":e.className;if(t=="INS"){return 0}else if(n.indexOf("rcjsload")>-1){return 1}else if(n.indexOf("revexitunit")>-1){return 1}else if(i.indexOf("advertiseAd")>-1){return 1}else if(i.indexOf("redirectAd")>-1){return 1}else if(i.indexOf("zergnetAd")>-1){return 1}else if(t=="IFRAME"){return 0}else{return 1}return-1},setClickCatch:function(e){this.clickIsHandled=e},addElementToProtect:function(e){var t=this;document.querySelectorAll(e).forEach(function(e){e.onmouseover=function(){if(t.overAnAd)return;t.overAnAd=true;t.adType=t.getType(e)};e.onmouseout=function(){t.overAnAd=false}});window.onblur(function(){if(t.clickIsHandled)return;if(!t.overAnAd)return;t.onClick();t.overAnAd=false});window.focus();t.lateShielding(e)},lateShielding:function(e){}};s.FillValue=function(e,t){switch(e){case"key":s.UserKey=t;break}};s.CheckViolations=function(){var e=document.referrer;var t={refererUrl:e,fullUrl:encodeURIComponent(e),source:GetParameterByName("utm_source"),subsource:GetParameterByName("utm_medium"),visitUrl:"",userAgent:navigator.userAgent,jsCheck:false,badBot:false,isAuto:false};if(e.indexOf("://")>-1){domain=e.split("/")[2]}else{domain=e.split("/")[0]}domain=domain.split(":")[0];t.visitUrl=document.location.toString()||"";try{t.jsCheck=s.checkJSEngine()}catch(e){}try{t.badBot=s.isBadBot()}catch(e){}try{t.isAuto=s.isAuto()}catch(e){}s.httpPost(s.urls.vlog+"/"+s.UserKey,t,function(e){if(typeof e.disabled!=="undefined"){console.log("User website has been disabled from AdShield. Plese contact your admin for more information.");return false}s.ViolationResponse(e)})};s.ViolationResponse=function(e,t){if(e.action=="allow"){s.displayAds(e.jsCode)}else if(e.action=="block"){return false}else if(e.action=="captcha"){s.violationId=e.violationId;s.displayCaptcha(e.jsCode)}};s.checkJSEngine=function(){if(typeof document=="undefined")return false;if(typeof document.URL=="undefined")return false;if(typeof window=="undefined")return false;if(typeof window.alert=="undefined")return false;if(typeof document.body=="undefined")return false;return true};s.isBadBot=function(){return false};s.displayCaptcha=function(e){s.constructCaptcha(function(){s.displayAds(e)},function(){console.log("not showing ads")})};s.displayAds=function(e){for(var t in e){var n=e[t];s.insertRawJs(n.code,n.container,n.intoContainer)}};s.insertRawJs=function(e,t,n){var i=document.createElement("div");i.innerHTML=e;var o=i.getElementsByTagName("script");for(var r=0;r<o.length;r++){var a=document.createElement("script");for(var l=0;l<o[r].attributes.length;l++){a.setAttribute(o[r].attributes[l].name,o[r].attributes[l].value)}a.innerHTML=o[r].innerHTML;try{if(n){document.getElementById(t).appendChild(a)}else{document.body.appendChild(a)}}catch(e){console.log(e)}}};s.constructCaptcha=function(t,n){var i=document.createElement("div");i.style.top=0;i.style.left=0;i.style.backgroundColor="#000";i.style.opacity=.6;i.style.width="100%";i.style.height="100%";i.style.position="fixed";i.style.zIndex="9999999999999999999999999";document.body.appendChild(i);var o=document.createElement("div");o.style.width="300px";o.style.height="200px";o.style.backgroundColor="#eee";o.style.left="50%";o.style.top="50%";o.style.position="absolute";o.style.transform="translate(-50%, -50%)";o.style.zIndex=i.style.zIndex+"1";o.style.padding="20px";document.body.appendChild(o);var r=document.createElement("div");o.appendChild(r);s.generateCaptcha(r);var a=document.createElement("input");a.type="text";a.style.width="100%";a.style.padding="6px";o.appendChild(a);var e=document.createElement("button");e.textContent="Submit";e.onclick=function(){var e=s.validateCaptcha(a.value);if(e){s.httpPost(s.urls.captchaUrl+"/"+s.UserKey+"/success",{violationId:s.violationId},function(e){t();document.body.removeChild(i);document.body.removeChild(o)})}else{s.httpPost(s.urls.captchaUrl+"/"+s.UserKey+"/failed",{violationId:s.violationId},function(e){s.generateCaptcha(r)})}};o.appendChild(e);var l=document.createElement("button");l.textContent="Refresh";l.onclick=function(){a.value="";s.generateCaptcha(r)};o.appendChild(l);var d=document.createElement("button");d.textContent="Cancel";d.onclick=function(){s.httpPost(s.urls.captchaUrl+"/"+s.UserKey+"/cancelled",{violationId:s.violationId},function(e){document.body.removeChild(i);document.body.removeChild(o);n()})};o.appendChild(d);s.httpPost(s.urls.captchaUrl+"/"+s.UserKey+"/shown",{violationId:s.violationId},function(e){})};s.generateCaptcha=function(e){e.innerHTML="";var t="0123456789abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var n=6;var i=[];for(var o=0;o<n;o++){var r=Math.floor(Math.random()*t.length+1);if(i.indexOf(t[r])==-1)i.push(t[r]);else o--}var a=document.createElement("canvas");a.id="captcha";a.width=100;a.height=50;var l=a.getContext("2d");l.font="25px Georgia";l.strokeText(i.join(""),0,30);s.code=i.join("");e.appendChild(a)};s.validateCaptcha=function(e){event.preventDefault();return e==s.code};s.isAuto=function(){if(window.callPhantom||window._phantom)return"PhantomJS";if(/PhantomJS/.test(window.navigator.userAgent))return"PhantomJS";if(!Function.prototype.bind)return"PhantomJS";if(Function.prototype.bind.toString().replace(/bind/g,"Error")!=Error.toString())return"PhantomJS";if(Function.prototype.toString.toString().replace(/toString/g,"Error")!=Error.toString())return"PhantomJS";if(navigator.webdriver==true)return"Selenium";if(window.document.documentElement.getAttribute("webdriver"))return"Selenium";return false};s.Init=function(){for(var e in _adshield){for(var t in _adshield[e]){s.FillValue(t,_adshield[e][t])}}if(s.UserKey==null){throw{name:"Credential required",message:"Can't find your UserKey. Please follow the instruction on integration from our doc page."}}s.AdShieldType=3;s.CheckIframed();s.CheckReferrerUrl();s.CheckViolations()}};AdShield=new AdShield;